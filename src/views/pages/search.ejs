<% include ../partials/top %>

<div>
    <form>
        <div class="form-group row search-row">
            <div class="col-sm-12">
                <input value="<%= locals.query %>" name="q" class="form-control form-control-lg" type="text" id="searchInput" aria-describedby="emailHelp" placeholder="Search for : Rushmore, Adobe CC, Wes Anderson...">
            </div>
        </div>
        <div class="d-flex justify-content-center">
            <div class="p-2">
                <button type="submit" class="btn btn-primary btn">Search</button>
            </div>
        </div>
    </form>
</div>

<main>
    <% if (locals.eTorrents) { %>
        <% if (eTorrents.length) { %>
            <ul class="list-group"></ul>
            <% eTorrents.forEach(function(eTorrent){ %>
                <li class="list-group-item">
                    <div class="row">
                        <div class="col-lg-8 col-sm-6 col-12 text-truncate" title="<%=eTorrent.t.title%>"><%=eTorrent.t.title%></div>
                        <div class="col-lg-1 col-sm-2 col-3 text-truncate" title="<%=eTorrent.t.seeds%> seeds"><%=eTorrent.meta.speed%></div>
                        <div class="col-lg-1 col-sm-2 col-3 text-truncate"><%=eTorrent.t.size%></div>
                        <div class="col-lg-1 col-sm-1 col-3">
                            <button class="btn btn-dark btn-sm" onclick="window.open('<%=eTorrent.t.desc%>','_blank');">show</button>
                        </div>
                        <div class="col-lg-1 col-sm-1 col-3">
                            <button class="btn btn-success btn-sm" data-toggle="modal" data-target="#exampleModal"
                                onclick="download('<%=eTorrent.b64%>')">download</button>
                        </div>
                    </div>
                </li>
            <% }); %>
            </ul>
        <% } else { %>
            <div class="text-xl-center text-dark"><br><br>No torrent found...</div>
        <% } %>
    <% } else { %>
        <div class="text-xl-center text-dark"><br><br>Waiting for a request...</div>
    <% } %>
</main>
</div>
<script>
        function download(b64){
            window.location = '/download?b64=' + b64;
        }
</script>

<% include ../partials/bot %>
